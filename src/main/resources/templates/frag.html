<div class="form-group" th:fragment="user_parameter (frag_name, frag_id, frag_type, frag_text, readonly)" th:id="${'group_'+frag_id}">
  <label class="font-weight-bold  m-0" th:id="${'label_'+frag_id}" th:for="${frag_id}" th:text="${frag_text}">Dummy</label>
  <input class="form-control" th:type="${frag_type}" th:id="${frag_id}" th:name="${frag_name}" th:if="${readonly}" placeholder="" readonly/>
  <input class="form-control" th:type="${frag_type}" th:id="${frag_id}" th:name="${frag_name}" th:unless="${readonly}" placeholder=""/>
</div>

<th:block th:fragment="common_parameters_block (common_first_id, common_last_id, common_age_id, common_email_id)">
  <div th:replace="frag::user_parameter('first', ${common_first_id}, 'text', 'First name', 'false')"></div>
  <div th:replace="frag::user_parameter('last', ${common_last_id}, 'text', 'Last name', 'false')"></div>
  <div th:replace="frag::user_parameter('age', ${common_age_id}, 'number', 'Age', 'false')"></div>
  <div th:replace="frag::user_parameter('email', ${common_email_id}, 'email', 'Email', 'false')"></div>
</th:block>

<th:block th:fragment="edit_block (edit_id_id, edit_first_id, edit_last_id, edit_age_id, edit_email_id, edit_password_id)">
  <div th:replace="frag::user_parameter('id', ${edit_id_id}, 'text', 'ID', 'true')"></div>
  <div th:replace="frag::common_parameters_block(${edit_first_id}, ${edit_last_id}, ${edit_age_id}, ${edit_email_id})"></div>
  <div th:replace="frag::user_parameter('password', ${edit_password_id}, 'password', 'Password', 'false')"></div>
</th:block>

<th:block th:fragment="users_list_block">
  <th th:attr="id=${'id_'+user.id}" scope="row" th:text="${user.id}">0</th>
  <td th:attr="id=${'first_'+user.id}" th:text="${user.firstName}">First</td>
  <td th:attr="id=${'last_'+user.id}" th:text="${user.lastName}">Last</td>
  <td th:attr="id=${'age_'+user.id}" th:text="${user.age}">21</td>
  <td th:attr="id=${'email_'+user.id}" th:text="${user.email}">name@mail.com</td>
  <td id="user_list_roles">
    <th:block th:each="role, stat : ${user.roles}">
      <label class="pl-2" th:id="${'role_'+user.id+'_'+stat.index}" th:text="${role.name}"></label>
    </th:block>
  </td>
</th:block>

<th:block th:fragment="users_list_headers">
  <th scope="col">ID</th>
  <th scope="col">First Name</th>
  <th scope="col">Last Name</th>
  <th scope="col">Age</th>
  <th scope="col">Email</th>
  <th scope="col">Role</th>
</th:block>

<th:block th:fragment="user_list">
  <div class="tab-pane bg-white fade show active" id="profile_id">
    <div class="row-auto">
      <h4 class="bg-light p-2">All users</h4>
    </div>
    <div class="row-auto p-4">
      <div class="table-responsive">
        <table class="table table-striped bg-white">
          <thead>
          <tr>
            <th:block th:replace="frag::users_list_headers"></th:block>
            <th scope="col">Edit</th>
            <th scope="col">Delete</th>
          </tr>
          </thead>
          <tbody>
          <tr th:each="user : ${users}">
            <th:block th:replace="frag::users_list_block"></th:block>
            <td>
              <button type="button" th:attr="id=${'edit_'+user.id},value=${user.id}" class="btn btn-info" data-toggle="modal" data-target="#modal_edit_id">
                Edit
              </button>
            </td>
            <td>
              <button type="button" th:attr="id=${'delete_'+user.id},value=${user.id}" class="btn btn-danger" data-toggle="modal" data-target="#modal_edit_id">
                Delete
              </button>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
  <div class="tab-pane fade" id="crud_id">
    <div class="row-auto">
      <h4 class="bg-light p-2">Add new user</h4>
    </div>
    <div class="row-auto bg-white">
      <div class="col-4 offset-4">
        <form class="p-4 text-center" id="new_user" action="/admin/update">
          <div th:replace="frag::common_parameters_block('add_first', 'add_last', 'add_age', 'add_email')"></div>
          <div th:replace="frag::user_parameter('password', 'add_password', 'password', 'Password', 'false')"></div>
          <div class="form-group">
            <label class="font-weight-bold m-0" for="permit_id">Role</label>
            <select class="custom-select" id="permit_id" name="role" multiple>
              <th:block th:each="permit, stat : ${permits}">
                <option th:id="${'permit_'+stat.index}" th:value="${permit}" th:text="${permit}">PERMIT</option>
              </th:block>
            </select>
          </div>
          <div class="col" align="center">
            <button type="submit" form="new_user" class="btn btn-success">Add new user</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</th:block>

<div class="tab-pane bg-white fade show active" id="about_id" th:fragment="about_user">
  <div class="row-auto">
    <h4 class="bg-light p-2">About user</h4>
  </div>
  <div class="row-auto p-4">
    <div class="table-responsive">
      <table class="table table-striped bg-white">
        <thead>
        <tr>
          <th:block th:replace="frag::users_list_headers"></th:block>
        </tr>
        </thead>
        <tbody>
        <tr th:each="user : ${users}">
          <th:block th:replace="frag::users_list_block"></th:block>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>